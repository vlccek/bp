\begin{figure}[!htp]

\begin{subfigure}[t]{0.45\textwidth}
\centering
\begin{tikzpicture}[auto]
\begin{axis}[
    % MV: axis equal image axis lines=middle, -> axis equal image, axis lines=middle,
    axis equal image, %axis lines=middle,
    xmin=-0, xmax=1, % rozsah na ose x
    ymin=0, ymax=1, % rozsah na ose y
]
\addplot [only marks, red,  mark=+] table {data/points.txt};
\draw[red] (axis cs: 0.7319939418114051, 0.5986584841970366) circle (2);
\draw[blue] (axis cs: 0.020584494295802447, 0.9699098521619943) circle (2);
\draw[green] (axis cs: 0.8324426408004217, 0.21233911067827616) circle (2);
\addplot [mark=none, color=blue]{-0.9331319082593055*x+0.9891179006047893};


\end{axis}
\end{tikzpicture}
\caption{20 bodů je umístěno do prostoru. Je vybrán jeden náhodný bod (označený červeným kroužkem) a k~němu je nalezen nejvzdálenější $f_1$ (označený modrý kroužkem) a k~němu je nalezen nejvzdálenější bod $f_2$ (označený zeleným kroužkem). Vznikne přímka dána body $f_1$ a $f_2$.}
\end{subfigure}%
\hfill
\begin{subfigure}[t]{0.45\textwidth}
\centering
\begin{tikzpicture}[auto]
\begin{axis}[
    % MV: axis equal image axis lines=middle, -> axis equal image, axis lines=middle,
    axis equal image,% axis lines=middle,
    xmin=-0, xmax=1, % rozsah na ose x
    ymin=0, ymax=1, % rozsah na ose y
]
\addplot [only marks, red,  mark=+] table {data/points.txt};

\addplot [mark=none, color=blue]{-0.9331319082593055*x+0.9891179006047893};


\addplot[only marks,green]  coordinates{(0.21936602633519917,0.7844204618433638)(0.5860498624454391,0.4422560741259731)(0.4989656852230379,0.5235170985967039)(0.09237250163327393,0.9029221718850465)(0.46151234520466733,0.5584660052387307)(0.020584494295802447,0.9699098521619943)(0.8324426408004217,0.21233911067827616)(0.4990881990594175,0.5234027770267748)(0.3942582376700823,0.6212229589407545)(0.5790062182979707,0.4488287232303999)(0.7508621358082932,0.2884644829783388)(0.4667994787187105,0.5535324122535499)(0.3455190930103283,0.6667030100040372)(0.34360967163737505,0.668484752013452)(0.7868819240523611,0.2548532692390556)(0.7330812269314801,0.30505641640914427)(0.0548413785472877,0.9379436603893877)(0.6063221413788916,0.4233393638000357)(0.6074885972732018,0.4222509065854778)(0.6395828714377785,0.392302715290089)};

\draw[gray, dotted] (axis cs: 0.3745401188473625,0.9507143064099162) -- (axis cs: 0.21936602633519917,0.7844204618433638 );
\draw[gray, dotted] (axis cs: 0.7319939418114051,0.5986584841970366) -- (axis cs: 0.5860498624454391,0.4422560741259731 );
\draw[gray, dotted] (axis cs: 0.15601864044243652,0.15599452033620265) -- (axis cs: 0.4989656852230379,0.5235170985967039 );
\draw[gray, dotted] (axis cs: 0.05808361216819946,0.8661761457749352) -- (axis cs: 0.09237250163327393,0.9029221718850465 );
\draw[gray, dotted] (axis cs: 0.6011150117432088,0.7080725777960455) -- (axis cs: 0.46151234520466733,0.5584660052387307 );
\draw[gray, dotted] (axis cs: 0.020584494295802447,0.9699098521619943) -- (axis cs: 0.020584494295802447,0.9699098521619943 );
\draw[gray, dotted] (axis cs: 0.8324426408004217,0.21233911067827616) -- (axis cs: 0.8324426408004217,0.21233911067827616 );
\draw[gray, dotted] (axis cs: 0.18182496720710062,0.18340450985343382) -- (axis cs: 0.4990881990594175,0.5234027770267748 );
\draw[gray, dotted] (axis cs: 0.3042422429595377,0.5247564316322378) -- (axis cs: 0.3942582376700823,0.6212229589407545 );
\draw[gray, dotted] (axis cs: 0.43194501864211576,0.2912291401980419) -- (axis cs: 0.5790062182979707,0.4488287232303999 );
\draw[gray, dotted] (axis cs: 0.6118528947223795,0.13949386065204183) -- (axis cs: 0.7508621358082932,0.2884644829783388 );
\draw[gray, dotted] (axis cs: 0.29214464853521815,0.3663618432936917) -- (axis cs: 0.4667994787187105,0.5535324122535499 );
\draw[gray, dotted] (axis cs: 0.45606998421703593,0.7851759613930136) -- (axis cs: 0.3455190930103283,0.6667030100040372 );
\draw[gray, dotted] (axis cs: 0.19967378215835974,0.5142344384136116) -- (axis cs: 0.34360967163737505,0.668484752013452 );
\draw[gray, dotted] (axis cs: 0.5924145688620425,0.046450412719997725) -- (axis cs: 0.7868819240523611,0.2548532692390556 );
\draw[gray, dotted] (axis cs: 0.6075448519014384,0.17052412368729153) -- (axis cs: 0.7330812269314801,0.30505641640914427 );
\draw[gray, dotted] (axis cs: 0.06505159298527952,0.9488855372533332) -- (axis cs: 0.0548413785472877,0.9379436603893877 );
\draw[gray, dotted] (axis cs: 0.9656320330745594,0.8083973481164611) -- (axis cs: 0.6063221413788916,0.4233393638000357 );
\draw[gray, dotted] (axis cs: 0.3046137691733707,0.09767211400638387) -- (axis cs: 0.6074885972732018,0.4222509065854778 );
\draw[gray, dotted] (axis cs: 0.6842330265121569,0.4401524937396013) -- (axis cs: 0.6395828714377785,0.392302715290089 );

\draw[blue] (axis cs: 0.49902694214122767, 0.5234599378117394) circle (2);


% MV: opraven compile error
\addplot [mark=none]{x*1.0716598491-0.01132};


\end{axis}
\end{tikzpicture}
\caption{Body jsou promítnuty na přímku (zelené body) a vznikne množina bodů $Z$. Z~množiny $Z$ je určen medián $m$ (označený modrým kroužkem). 
% Prostor je rozdělen na dvě části ohraničené nově vzniklou přijímkou kolmou na $f_1 \rightarrow f_2$ 
}
\end{subfigure}


\begin{subfigure}[t]{1\textwidth}
\centering
\begin{tikzpicture}[auto]
\centering
\begin{axis}[
    % MV: axis equal image axis lines=middle, -> axis equal image, axis lines=middle,
    axis equal image,% axis lines=middle,
    xmin=-0, xmax=1, % rozsah na ose x
    ymin=0, ymax=1, % rozsah na ose y
]

\addplot [mark=none, color=blue]{-0.9331319082593055*x+0.9891179006047893};

\draw[gray, dotted] (axis cs: 0.3745401188473625,0.9507143064099162) -- (axis cs: 0.21936602633519917,0.7844204618433638 );
\draw[gray, dotted] (axis cs: 0.7319939418114051,0.5986584841970366) -- (axis cs: 0.5860498624454391,0.4422560741259731 );
\draw[gray, dotted] (axis cs: 0.15601864044243652,0.15599452033620265) -- (axis cs: 0.4989656852230379,0.5235170985967039 );
\draw[gray, dotted] (axis cs: 0.05808361216819946,0.8661761457749352) -- (axis cs: 0.09237250163327393,0.9029221718850465 );
\draw[gray, dotted] (axis cs: 0.6011150117432088,0.7080725777960455) -- (axis cs: 0.46151234520466733,0.5584660052387307 );
\draw[gray, dotted] (axis cs: 0.020584494295802447,0.9699098521619943) -- (axis cs: 0.020584494295802447,0.9699098521619943 );
\draw[gray, dotted] (axis cs: 0.8324426408004217,0.21233911067827616) -- (axis cs: 0.8324426408004217,0.21233911067827616 );
\draw[gray, dotted] (axis cs: 0.18182496720710062,0.18340450985343382) -- (axis cs: 0.4990881990594175,0.5234027770267748 );
\draw[gray, dotted] (axis cs: 0.3042422429595377,0.5247564316322378) -- (axis cs: 0.3942582376700823,0.6212229589407545 );
\draw[gray, dotted] (axis cs: 0.43194501864211576,0.2912291401980419) -- (axis cs: 0.5790062182979707,0.4488287232303999 );
\draw[gray, dotted] (axis cs: 0.6118528947223795,0.13949386065204183) -- (axis cs: 0.7508621358082932,0.2884644829783388 );
\draw[gray, dotted] (axis cs: 0.29214464853521815,0.3663618432936917) -- (axis cs: 0.4667994787187105,0.5535324122535499 );
\draw[gray, dotted] (axis cs: 0.45606998421703593,0.7851759613930136) -- (axis cs: 0.3455190930103283,0.6667030100040372 );
\draw[gray, dotted] (axis cs: 0.19967378215835974,0.5142344384136116) -- (axis cs: 0.34360967163737505,0.668484752013452 );
\draw[gray, dotted] (axis cs: 0.5924145688620425,0.046450412719997725) -- (axis cs: 0.7868819240523611,0.2548532692390556 );
\draw[gray, dotted] (axis cs: 0.6075448519014384,0.17052412368729153) -- (axis cs: 0.7330812269314801,0.30505641640914427 );
\draw[gray, dotted] (axis cs: 0.06505159298527952,0.9488855372533332) -- (axis cs: 0.0548413785472877,0.9379436603893877 );
\draw[gray, dotted] (axis cs: 0.9656320330745594,0.8083973481164611) -- (axis cs: 0.6063221413788916,0.4233393638000357 );
\draw[gray, dotted] (axis cs: 0.3046137691733707,0.09767211400638387) -- (axis cs: 0.6074885972732018,0.4222509065854778 );
\draw[gray, dotted] (axis cs: 0.6842330265121569,0.4401524937396013) -- (axis cs: 0.6395828714377785,0.392302715290089 );

% MV: opraven compile error
\addplot [mark=none,color=gray]{x*1.0716598491-0.01132};


\addplot[mark=+, only marks,red]  coordinates{(0.7319939418114051,0.5986584841970366)(0.8324426408004217,0.21233911067827616)(0.43194501864211576,0.2912291401980419)(0.6118528947223795,0.13949386065204183)(0.5924145688620425,0.046450412719997725)(0.6075448519014384,0.17052412368729153)(0.9656320330745594,0.8083973481164611)(0.3046137691733707,0.09767211400638387)(0.6842330265121569,0.4401524937396013)};
\addplot[mark=+, only marks,orange]  coordinates{(0.3745401188473625,0.9507143064099162)(0.15601864044243652,0.15599452033620265)(0.05808361216819946,0.8661761457749352)(0.6011150117432088,0.7080725777960455)(0.020584494295802447,0.9699098521619943)(0.18182496720710062,0.18340450985343382)(0.3042422429595377,0.5247564316322378)(0.29214464853521815,0.3663618432936917)(0.45606998421703593,0.7851759613930136)(0.19967378215835974,0.5142344384136116)(0.06505159298527952,0.9488855372533332)};
\addplot[only marks,orange]  coordinates{(0.21936602633519917,0.7844204618433638)(0.4989656852230379,0.5235170985967039)(0.09237250163327393,0.9029221718850465)(0.46151234520466733,0.5584660052387307)(0.020584494295802447,0.9699098521619943)(0.4990881990594175,0.5234027770267748)(0.3942582376700823,0.6212229589407545)(0.4667994787187105,0.5535324122535499)(0.3455190930103283,0.6667030100040372)(0.34360967163737505,0.668484752013452)(0.0548413785472877,0.9379436603893877)};
\addplot[only marks,red]  coordinates{(0.5860498624454391,0.4422560741259731)(0.8324426408004217,0.21233911067827616)(0.5790062182979707,0.4488287232303999)(0.7508621358082932,0.2884644829783388)(0.7868819240523611,0.2548532692390556)(0.7330812269314801,0.30505641640914427)(0.6063221413788916,0.4233393638000357)(0.6074885972732018,0.4222509065854778)(0.6395828714377785,0.392302715290089)};

% kruhy a jejich středy
\addplot[only marks,orange, mark=triangle*]  coordinates{(0.24630446323268557,0.6339714658471286)};
\addplot[only marks,red, mark=triangle*]  coordinates{(0.64029697172221,0.3116574542216814)};

\node [draw, orange] at ( axis cs:0.24630446323268557,0.6339714658471286) [circle through={(axis cs: 0.15601864044243652, 0.15599452033620265)}] {};
\node [draw, red] at ( axis cs:0.64029697172221,0.3116574542216814) [circle through={(axis cs: 0.9656320330745594,0.8083973481164611)}] {};


\end{axis}
\end{tikzpicture}
\caption{Body jsou rozděleny do množiny $S_l$ (oranžové \uv{+}) a $S_r$ (červené \uv{+}), podle toho, zda jejich promítnutí je větší nebo menší než medián. Vzniknou dvě koule (kružnice) obepínající všechny body dvou množin (červené a oranžové kružnice). }
\end{subfigure}
\caption{Znázornění konstrukce balltree pro $p=2$.}
\label{fig:balltree_construction}
\end{figure}